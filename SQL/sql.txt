Because of lacking previlege to work on the public schema such as deleting records and altering attributes,
we first copy some tables from the public schema to our personal schema.
       
1) create table 23357335.myblock as
   select * from public.block;

2) create table s2257335.mybservation as 
   select * from public.observation
   where obsdate BETWEEN '2017-01-01' AND '2017-06-30'

3) create table s2257335.myprecip as
   select * from public.precipitation
   where dtime BETWEEN '2017-01-01' AND '2017-06-30'
 
4) create table s2257335.mytemperature as
   select * from public.temperature
   where dtime BETWEEN '2017-01-01' AND '2017-06-30'
    
    
    
    
--- For the block table---

Cheking for the duplicated records (latit and longit)

SELECT block, latit, longit, geom FROM block WHERE (latit, longit) IN
  (SELECT latit, longit FROM block GROUP BY (latit, longit) HAVING COUNT(*) > 1)

Filtering out the duplicates

select distinct on (longit, latit) *
from myblock

Delete the blocks outside the Netherlands (2 blocks)

DELETE FROM myblock
WHERE block = 44643 and longit = 249 and latit = 0 and urlnr = '870169';
                                    &&
DELETE FROM myblock
WHERE block = 44644 and longit = 254 and latit = 0 and urlnr = '870170';

Creating new table and ingest records without duplicates

create table s2257335.myblock as 
select distinct on (longit, latit) *
from public.block 


--- Calculating the observer intensity ---

create table obs_int
select block, obsdate, count(distinct oberver) as obsint
from s2257335.myobservation
group by obsdate, block
order by obsdate, block

--- There was a data format problem both in mytemperature and my precip table ---

ALTER TABLE s2257335.mytemperature
ALTER COLUMN dtime TYPE integer USING dtime::date;

ALTER TABLE s2257335.mytemprecip
ALTER COLUMN dtime TYPE integer USING dtime::date;
 


--- Joining the tables s2257335.mytemperature, s2257335.myprecip, and s2257335.myblock ---

select t.block, t.temper, p.precip, t.dtime
from s2257335.mytemperature as t
inner join s2257335.myprecip as p on t.dtime = p.dtime AND p.block = t.block
where t.block IN (select block from s2257335.myblock)
order by t.dtime, t.block asc
